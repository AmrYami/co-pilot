namespace: dw::common
route: /dw/rate

tests:
  - name: 01-order-only
    request:
      inquiry_id: 9101
      rating: 1
      comment: "order_by: REQUEST_DATE desc;"
    expect:
      sql_contains:
        - "ORDER BY REQUEST_DATE DESC"

  - name: 02-fts-single
    request:
      inquiry_id: 9102
      rating: 1
      comment: "fts: it; order_by: REQUEST_DATE desc;"
    expect:
      binds:
        fts_0: "%it%"
      sql_contains:
        - "LIKE UPPER(:fts_0)"
        - "ORDER BY REQUEST_DATE DESC"

  - name: 03-fts-or-entity-or
    request:
      inquiry_id: 9103
      rating: 1
      comment: "fts: it or home care; eq: ENTITY = DSFH or Farabi; order_by: REQUEST_DATE desc;"
    expect:
      binds:
        fts_0: "%it%"
        fts_1: "%home care%"
        eq_0: "DSFH"
        eq_1: "Farabi"
      sql_contains:
        - "LIKE UPPER(:fts_0)"
        - "LIKE UPPER(:fts_1)"
        - "ORDER BY REQUEST_DATE DESC"

  - name: 04-full-scenario
    request:
      inquiry_id: 9104
      rating: 1
      comment: >
        fts: it or home care;
        eq: ENTITY = DSFH or Farabi;
        eq: REPRESENTATIVE_EMAIL = samer@procare-sa.com or rehab.elfwakhry@oracle.com;
        eq: stakeholder = Amr Taher A Maghrabi or Abdulellah Mazen Fakeeh;
        eq: department = AL FARABI or SUPPORT SERVICES;
        order_by: REQUEST_DATE desc;
    expect:
      binds:
        fts_0: "%it%"
        fts_1: "%home care%"
        eq_0: "DSFH"
        eq_1: "Farabi"
        eq_2: "samer@procare-sa.com"
        eq_3: "rehab.elfwakhry@oracle.com"
        eq_4: "Amr Taher A Maghrabi"
        eq_5: "Abdulellah Mazen Fakeeh"
        eq_6: "AL FARABI"
        eq_7: "SUPPORT SERVICES"
      sql_contains:
        - "LIKE UPPER(:fts_0)"
        - "LIKE UPPER(:fts_1)"
        - "ORDER BY REQUEST_DATE DESC"
